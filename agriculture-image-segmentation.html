<!DOCTYPE html>
<html lang="en">

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5F9Y9HC95G"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5F9Y9HC95G');
</script>
<script data-ad-client="ca-pub-8325812071117232" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Agricultural Image Segmentation">
    <meta property="og:type" content="blog">
  <title>Agricultural Image Segmentation</title>
<link rel="icon" href="⚡"/>
  <!-- Favicon -->
    <link rel="shortcut icon" target="_blank" href="⚡">
    <link rel="stylesheet" type="text/css" target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index">
      <div class="Navbar__Btn"><span>⚡</span> <span>Home</span></div>
    </a>
                                                                                                                                                                                                                                                                                                                                                                              </nav>
  <header class="Header">
          <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
        <h1 class="Header__Title">Agricultural Image Segmentation</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Wed, Jan 6, 2021</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a target="_blank" href="tag/Image Segmentation">Image Segmentation</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/cd8ad57b8dba49ebabe9a0bff88255cc" class="PageRoot"><div id="https://www.notion.so/b40a886d7c7e46b8964ecdb14e404b0f" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1316d22-f54f-4af7-bc96-acd60e23cddf%2FUntitled.png?width=949&amp;table=block&amp;id=b40a886d-7c7e-46b8-964e-cdb14e404b0f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1316d22-f54f-4af7-bc96-acd60e23cddf%2FUntitled.png?width=949&amp;table=block&amp;id=b40a886d-7c7e-46b8-964e-cdb14e404b0f" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h1 id="https://www.notion.so/bbdcf66965f24be7bee09218c634672d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" target="_blank" href="#https://www.notion.so/bbdcf66965f24be7bee09218c634672d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Data</span></span></h1><div id="https://www.notion.so/5910486256db4df78fa44de8b5b90fa6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1 image with 1800 x 1135 resolution and 60 channels</span></span></p></div><div id="https://www.notion.so/ec347ef9cd754cda88e1e46ed9bafe15" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F20ded986-ab09-47a0-86ab-8f334099fe96%2FUntitled.png?width=1117&amp;table=block&amp;id=ec347ef9-cd75-4cda-88e1-e46ed9bafe15"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F20ded986-ab09-47a0-86ab-8f334099fe96%2FUntitled.png?width=1117&amp;table=block&amp;id=ec347ef9-cd75-4cda-88e1-e46ed9bafe15" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/20ee08f9aa1e47f98217e04abcd8ac88" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">There are 60 bands given by images.tif. The labels data given by labels.tif. There are 8 labels ranging from 1 to 8. 0 value in the label image means no data label available for that pixel. So, it requires a loss function that ignores nodata label (0).</span></span></p></div><div id="https://www.notion.so/bf84b66ff04143d3a2c5f395e00d28c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Every Month 5 bands images were shot from agricultural land for 12 months. So, 5 bands * 12 = 60 bands. The 8 labels mean, 8 types of cropland. There is an assumption that the spectral signal of each crop type varies with bands and months.</span></span></p></div><div id="https://www.notion.so/3f4fa4f6c5394b0a8e6896be7baa6cb7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The goal of semantic segmentation is to produce a map of croplands. So, the output will be the same size of labels.tif, with all 0 (no labels) pixels classified into one of 8 classes.</span></span></p></div><div id="https://www.notion.so/8158210eba604942981b99b0bbb9afcc" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0df09da3-a40c-42f8-8436-66cd01f0f9ba%2FUntitled.png?width=943&amp;table=block&amp;id=8158210e-ba60-4942-981b-99b0bbb9afcc"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0df09da3-a40c-42f8-8436-66cd01f0f9ba%2FUntitled.png?width=943&amp;table=block&amp;id=8158210e-ba60-4942-981b-99b0bbb9afcc" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/34c42b0abbfa48838a76c9867815e795" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Labels: 1 → Crop A, 2 → Crop B, 3 → Crop C, 4 → Crop D, 6 → Crop E, 7 → Crop F, 8 → Crop G</span></span></p></div><div id="https://www.notion.so/56dd6f6941d54930a119e7650aac974c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Sample images required for training and validation can be generated by patching with a sliding window. The size of the patches depends on the model to be applied. Input is a whole 60 bands image. If the model does not support the input of 60 bands image, it is reduced into 3 bands by PCA.</span></span></p></div><h1 id="https://www.notion.so/2c5359c3db4344f0ad9d72014b3e9cab" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" target="_blank" href="#https://www.notion.so/2c5359c3db4344f0ad9d72014b3e9cab"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Bag of tricks</span></span></h1><ol class="NumberedListWrapper"><li id="https://www.notion.so/92afc0abd4e24f3fb55c417cfc849dad" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">Adaptive histogram equalization [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://towardsdatascience.com/histogram-equalization-5d1013626e64">ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/95e6f650086347c8b1c800b7074ca322" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">Image Augmentation with </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/albumentations-team/albumentations">Albumentations</a></span></span></li><li id="https://www.notion.so/644618252ba34a49a273530ce2b08a06" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Normalized 3d numpy array - overall or channel-wise</span></span></li><li id="https://www.notion.so/56874b5f10534a6eb79088a5af962af0" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">Label balancing - how? - sampler</span></span></li><li id="https://www.notion.so/08e6a93d3319479583c97acc9c35603b" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString">Try Fine-grained U-net (FG-Unet) architecture</span></span></li><li id="https://www.notion.so/8c90c773c5e046948051f0aca7ec7e03" class="NumberedList" value="6"><span class="SemanticStringArray"><span class="SemanticString">Add sobel edge detection logic in loss function</span></span></li><li id="https://www.notion.so/78c8c6858ef944f4ba566fdc84e1cb76" class="NumberedList" value="7"><span class="SemanticStringArray"><span class="SemanticString">Try WDL instead of WBCE [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/killthekitten/kaggle-carvana-2017/blob/master/losses.py">Ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/e0a1abec119441d6aaa951e39f198ef3" class="NumberedList" value="8"><span class="SemanticStringArray"><span class="SemanticString">How to add pixel weighting component [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/jaidevd/jaidevd.github.io/blob/source/blog/posts/code/weighted_loss_unet.py">Ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/1686cf65dffd43ae8f8a66af2801c664" class="NumberedList" value="9"><span class="SemanticStringArray"><span class="SemanticString">RGB Weight initialization scheme? [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/olgaliak/segmentation-unet-maskrcnn/blob/master/unet/model.py">Ref</a></span><span class="SemanticString">] [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://arxiv.org/abs/1801.05746">Ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/07ffc217c0ab458aa1f65efe1db939bc" class="NumberedList" value="10"><span class="SemanticStringArray"><span class="SemanticString">Baseline: Vanilla Deep UNet</span></span></li><li id="https://www.notion.so/ba1ebe5232584066acb73c9b235c775f" class="NumberedList" value="11"><span class="SemanticStringArray"><span class="SemanticString">+ Residual connection</span></span></li><li id="https://www.notion.so/d2de64048a3c4818b9c0c42a8fd35d4a" class="NumberedList" value="12"><span class="SemanticStringArray"><span class="SemanticString">+ Atrous convolutions</span></span></li><li id="https://www.notion.so/4bbc7b0fd3384fedbd44f23b61b22756" class="NumberedList" value="13"><span class="SemanticStringArray"><span class="SemanticString">+ Pyramid scene parse pooling</span></span></li><li id="https://www.notion.so/32ad4bbe423a43b19cff9be98e9be66f" class="NumberedList" value="14"><span class="SemanticStringArray"><span class="SemanticString">+ Multitask inference</span></span></li><li id="https://www.notion.so/f9a7ab5d46ca4aa5893b0ddcf213ede5" class="NumberedList" value="15"><span class="SemanticStringArray"><span class="SemanticString">+ CRF post processing</span></span></li><li id="https://www.notion.so/d2240fdf0687421996a81b220707c000" class="NumberedList" value="16"><span class="SemanticStringArray"><span class="SemanticString">+ Boundary sharpening</span></span></li><li id="https://www.notion.so/e888caf8f63a4129af8e7df08fa9e6ee" class="NumberedList" value="17"><span class="SemanticStringArray"><span class="SemanticString">+ Fine grained Unet</span></span></li><li id="https://www.notion.so/a2b5822fd3224f58b368c4e9b311053f" class="NumberedList" value="18"><span class="SemanticStringArray"><span class="SemanticString">+ Late temporal fusion</span></span></li><li id="https://www.notion.so/a697d1535a5b4f0ba5d7cc69cde57dfd" class="NumberedList" value="19"><span class="SemanticStringArray"><span class="SemanticString">+ Percentile normalization fitting</span></span></li><li id="https://www.notion.so/426eac17a76c463d853edab49acb91f9" class="NumberedList" value="20"><span class="SemanticStringArray"><span class="SemanticString">+ Patch normalization transform</span></span></li><li id="https://www.notion.so/892a4063704c4f42b91ad61798ac850c" class="NumberedList" value="21"><span class="SemanticStringArray"><span class="SemanticString">+ Lower threshold (90%)</span></span></li><li id="https://www.notion.so/8bb878ecd9e34ca1ae4d718a2fb2febf" class="NumberedList" value="22"><span class="SemanticStringArray"><span class="SemanticString">+ On fly patch generation</span></span></li><li id="https://www.notion.so/d1589152de594de59d02fd1a59973459" class="NumberedList" value="23"><span class="SemanticStringArray"><span class="SemanticString">+ Patch stitch averaging</span></span></li></ol><h3 id="https://www.notion.so/a34da26dfbbd4e30afb9962ac6a03381" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" target="_blank" href="#https://www.notion.so/a34da26dfbbd4e30afb9962ac6a03381"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Augmentation scheme</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/a824e3a442e142eb817b03444af5886f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Random rotation by 90 degrees</span></span></li><li id="https://www.notion.so/4696129ac1664301bae7dc029bb18d96" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Horizontal and Vertical flip</span></span></li><li id="https://www.notion.so/9ee0a67711604b8c8ce64b24c4f1a16b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Heavy Geometric Transformations</span></span></li><li id="https://www.notion.so/05b5741fe869427d95ad6c4105ae9dad" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Random HSV</span></span></li><li id="https://www.notion.so/f07400cedea84c8eabe90b5db56910a3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Loss-less augmentation</span></span></li><li id="https://www.notion.so/da7ff3cb4549465f94b73c366641ede9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Channel shuffling</span></span></li><li id="https://www.notion.so/6da4f9069fe04bfeb9c082b49afb0214" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Data augmentation based on class frequency</span></span></li><li id="https://www.notion.so/adcfe48c1162476380de29d7de19f5ab" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Apply gaussian noise</span></span></li><li id="https://www.notion.so/cf948c21d0ea4fa4b1715a469d3f8503" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Scale by a random factor from 0.8 to 1.2</span></span></li><li id="https://www.notion.so/ac3e17347cdd44e8ae3a69db94ab79fe" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Brighness changing</span></span></li></ul><h3 id="https://www.notion.so/24006f5820784c899d259b4fd009264c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" target="_blank" href="#https://www.notion.so/24006f5820784c899d259b4fd009264c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Loss functions</span></span></h3><details id="https://www.notion.so/77d9a6058e8b491f81f5e5843fb0b7da" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Ref images</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/76c4d98501d7414b948fcf4198bdcaaf" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F657ac98e-a12d-45a7-87c7-64dd79fc508f%2FUntitled.png?width=984&amp;table=block&amp;id=76c4d985-01d7-414b-948f-cf4198bdcaaf"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F657ac98e-a12d-45a7-87c7-64dd79fc508f%2FUntitled.png?width=984&amp;table=block&amp;id=76c4d985-01d7-414b-948f-cf4198bdcaaf" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0a09bf6a28604b4fa2f15fe2d4591e95" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9801a21c-6451-4e53-8fa3-e0b050a99eee%2FUntitled.png?width=984&amp;table=block&amp;id=0a09bf6a-2860-4b4f-a2f1-5fe2d4591e95"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9801a21c-6451-4e53-8fa3-e0b050a99eee%2FUntitled.png?width=984&amp;table=block&amp;id=0a09bf6a-2860-4b4f-a2f1-5fe2d4591e95" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2e2930ed52324290ae577e35c4aa6233" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9536f18a-ad44-443a-b651-f2fe381a9b0c%2FUntitled.png?width=1507&amp;table=block&amp;id=2e2930ed-5232-4290-ae57-7e35c4aa6233"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9536f18a-ad44-443a-b651-f2fe381a9b0c%2FUntitled.png?width=1507&amp;table=block&amp;id=2e2930ed-5232-4290-ae57-7e35c4aa6233" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></details><details id="https://www.notion.so/5c7af0ebc31541eeadad3482b40fba7c" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Code snippets</span></span></summary><div class="Toggle__Content"><pre id="https://www.notion.so/6d9d7ec1d1ac429f877b3470ef452bbe" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">soft_dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token triple-quoted-string string">''' 
    Soft dice loss calculation for arbitrary batch size, number of classes, and number of spatial dimensions.
    Assumes the `channels_last` format.
  
    # Arguments
        y_true: b x X x Y( x Z...) x c One hot encoding of ground truth
        y_pred: b x X x Y( x Z...) x c Network output, must sum to 1 over c channel (such as after softmax) 
        epsilon: Used for numerical stability to avoid divide by zero errors
    
    # References
        V-Net: Fully Convolutional Neural Networks for Volumetric Medical Image Segmentation 
        https://arxiv.org/abs/1606.04797
        More details on Dice loss formulation 
        https://mediatum.ub.tum.de/doc/1395260/1395260.pdf (page 72)
        
        Adapted from https://github.com/Lasagne/Recipes/issues/99#issuecomment-347775022
    '''</span>
    
    <span class="token comment"># skip the batch and class axis for calculating Dice score</span>
    axes <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    numerator <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_pred <span class="token operator">*</span> y_true<span class="token punctuation">,</span> axes<span class="token punctuation">)</span>
    denominator <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_true<span class="token punctuation">)</span><span class="token punctuation">,</span> axes<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>numerator <span class="token operator">/</span> <span class="token punctuation">(</span>denominator <span class="token operator">+</span> epsilon<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># average over classes and batch</span></span></span></span></code></pre><pre id="https://www.notion.so/637acf05a7bb42af8bbd7db9f1f895b2" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">jaccard_coef</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    intersection <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">*</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sum_ <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">+</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    jac <span class="token operator">=</span> <span class="token punctuation">(</span>intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sum_ <span class="token operator">-</span> intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span>
    <span class="token keyword">return</span> K<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>jac<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
  numerator <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true <span class="token operator">*</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  denominator <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true <span class="token operator">+</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> numerator <span class="token operator">/</span> denominator


<span class="token keyword">def</span> <span class="token function">focal_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    output <span class="token operator">/=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    eps <span class="token operator">=</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> K<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>output<span class="token punctuation">,</span> eps<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">-</span> eps<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>K<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">-</span> output<span class="token punctuation">,</span> gamma<span class="token punctuation">)</span> <span class="token operator">*</span> target <span class="token operator">*</span> K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span></span></span></code></pre><pre id="https://www.notion.so/e50483141c41491db0c83489b4c89224" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">weighted_categorical_crossentropy</span><span class="token punctuation">(</span>weights<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A weighted version of keras.objectives.categorical_crossentropy
    
    Variables:
        weights: numpy array of shape (C,) where C is the number of classes
    
    Usage:
        weights = np.array([0.5,2,10]) # Class one at 0.5, class 2 twice the normal weights, class 3 10x.
        loss = weighted_categorical_crossentropy(weights)
        model.compile(loss=loss,optimizer='adam')
    """</span>
    
    weights <span class="token operator">=</span> K<span class="token punctuation">.</span>variable<span class="token punctuation">(</span>weights<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># scale predictions so that the class probas of each sample sum to 1</span>
        y_pred <span class="token operator">/=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token comment"># clip to prevent NaN's and Inf's</span>
        y_pred <span class="token operator">=</span> K<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># calc</span>
        loss <span class="token operator">=</span> y_true <span class="token operator">*</span> K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span> <span class="token operator">*</span> weights
        loss <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>loss<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> loss
    
    <span class="token keyword">return</span> loss</span></span></span></code></pre><pre id="https://www.notion.so/c649547f46c24d68a3885bf5614471bc" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">dice_coeff</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    smooth <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">.</span>
    <span class="token comment"># Flatten</span>
    y_true_f <span class="token operator">=</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    y_pred_f <span class="token operator">=</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    intersection <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true_f <span class="token operator">*</span> y_pred_f<span class="token punctuation">)</span>
    score <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">*</span> intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true_f<span class="token punctuation">)</span> <span class="token operator">+</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_pred_f<span class="token punctuation">)</span> <span class="token operator">+</span> smooth<span class="token punctuation">)</span>
    <span class="token keyword">return</span> score

<span class="token keyword">def</span> <span class="token function">dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> dice_coeff<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss

<span class="token keyword">def</span> <span class="token function">bce_dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> losses<span class="token punctuation">.</span>binary_crossentropy<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span> <span class="token operator">+</span> dice_loss<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss</span></span></span></code></pre><pre id="https://www.notion.so/40e8d35a884644b1b21ee94ea4803955" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>_EPSILON <span class="token operator">=</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span>
nb_class<span class="token operator">=</span><span class="token number">9</span> <span class="token comment"># number of objects plus the background</span>
<span class="token keyword">def</span> <span class="token function">custom_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
  y_pred <span class="token operator">=</span> K<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> _EPSILON<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token operator">-</span>_EPSILON<span class="token punctuation">)</span>

  <span class="token comment"># find predictions</span>
  pred<span class="token operator">=</span>K<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment"># find missing annotations per class</span>
  y_trueAny<span class="token operator">=</span>K<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  <span class="token comment">#print "missing annotations",K.eval(y_trueAny)</span>

  backgroundWeights<span class="token operator">=</span><span class="token number">1</span>
  <span class="token keyword">for</span> cls <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>nb_class<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token comment"># we use repeat to get the same size as other tensors</span>
      y_trueAnyRepeat<span class="token operator">=</span>K<span class="token punctuation">.</span>repeat_elements<span class="token punctuation">(</span>y_trueAny<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>cls<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token comment">#print "repeat shape",K.eval(K.shape(y_trueAnyRepeat))</span>
      
      <span class="token comment"># check for two conditions</span>
      <span class="token comment"># 1- annotation missing</span>
      <span class="token comment"># 2- prediction is equal to missing class/object</span>
      backgroundWeights<span class="token operator">*=</span>K<span class="token punctuation">.</span>not_equal<span class="token punctuation">(</span>pred<span class="token punctuation">,</span>cls<span class="token punctuation">)</span><span class="token operator">+</span>y_trueAnyRepeat
      <span class="token comment">#print "background weights shape",K.eval(K.shape(backgroundWeights)),K.eval(K.shape(pred))</span>
      <span class="token comment">#print "sum of background weights",cls,K.eval(K.sum(backgroundWeig0.191179hts))</span>

  <span class="token comment"># loss for background</span>
  loss<span class="token operator">=</span>backgroundWeights<span class="token operator">*</span>y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> cls <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>nb_class<span class="token punctuation">)</span><span class="token punctuation">:</span>
      loss<span class="token operator">+=</span>y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>cls<span class="token punctuation">]</span><span class="token operator">*</span>K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>cls<span class="token punctuation">]</span><span class="token punctuation">)</span>
      
  <span class="token keyword">return</span> <span class="token operator">-</span>loss</span></span></span></code></pre><pre id="https://www.notion.so/7cb2958b84f94ddcbced31d0052d40f5" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">dice_coef_rb</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> smooth<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_true <span class="token operator">=</span> K<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> <span class="token string">'int32'</span><span class="token punctuation">)</span>
    y_true <span class="token operator">=</span> K<span class="token punctuation">.</span>one_hot<span class="token punctuation">(</span>y_true<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    y_pred <span class="token operator">=</span> y_pred<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    intersection <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">*</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sum_ <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">+</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> K<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">*</span> intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sum_ <span class="token operator">+</span> smooth<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">dice_coef_loss_rb</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> dice_coef_rb<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span></span></span></code></pre></div></details><ol class="NumberedListWrapper"><li id="https://www.notion.so/d6105ef708194d4e84d2f1e925dd28e8" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">Dice loss</span></span></li><li id="https://www.notion.so/4a7d59a5488b43f6bf49e0c9aa97f9a8" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">Class weights</span></span></li><li id="https://www.notion.so/066b8c36706148eb8f8bbe31d9d2a226" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Pixel weighted (weighted boundary loss - </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://www.kaggle.com/lyakaap/weighing-boundary-pixels-loss-script-by-keras2">code</a></span><span class="SemanticString">)</span></span></li><li id="https://www.notion.so/42dc690771b44c3494c4673756c842f6" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">Combination of BCE, Dice and Focal</span></span></li></ol><h3 id="https://www.notion.so/9e780d7bee464c7da63dedd4c1d8f9ce" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" target="_blank" href="#https://www.notion.so/9e780d7bee464c7da63dedd4c1d8f9ce"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Hyperparameters</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/7f4d3b87ffa74a4fb1a3b8b6e2434bd6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Binary class vs. Multiclass</span></span></li><li id="https://www.notion.so/e9ddf79a21704a8f99d7d1cbfb2e75b9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Standardisation channel-wise or image-wise</span></span></li><li id="https://www.notion.so/dd4d01502fa347bcbf9b432f5b1bf275" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Class weights</span></span></li><li id="https://www.notion.so/08c2681a5ce34f8e8ab6de736479e09b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Patch-based vs. Stride</span></span></li><li id="https://www.notion.so/51f91d903ac248ee9bcc48c5f9c8cf5c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Augmentation</span></span></li><li id="https://www.notion.so/afd329e89f6942939ca2491aab78c302" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">U-net model architecture</span></span></li><li id="https://www.notion.so/ea9666b2cdba4167b19aaba566b7aa05" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Loss function</span></span></li></ul><h1 id="https://www.notion.so/734618ecc2aa4158a3d0422ce984a7fd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" target="_blank" href="#https://www.notion.so/734618ecc2aa4158a3d0422ce984a7fd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Results and Discussion</span></span></h1><div id="https://www.notion.so/fe115a0ac1a44a9382a24be674c6547b" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4312e869-4afd-4018-955f-e36ece5ae8f6%2FUntitled.png?width=851&amp;table=block&amp;id=fe115a0a-c1a4-4a93-82a2-4be674c6547b"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4312e869-4afd-4018-955f-e36ece5ae8f6%2FUntitled.png?width=851&amp;table=block&amp;id=fe115a0a-c1a4-4a93-82a2-4be674c6547b" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/e81c4c1766ae43ebae71b761e5389f71" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc491844a-d08e-43ea-9133-a131ffdc2bfe%2FUntitled.png?width=851&amp;table=block&amp;id=e81c4c17-66ae-43eb-ae71-b761e5389f71"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc491844a-d08e-43ea-9133-a131ffdc2bfe%2FUntitled.png?width=851&amp;table=block&amp;id=e81c4c17-66ae-43eb-ae71-b761e5389f71" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/60783d5e36f0461488cd642eaaa35067" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa03315f2-d315-45f7-9f63-0c4db16f161b%2FUntitled.png?width=851&amp;table=block&amp;id=60783d5e-36f0-4614-88cd-642eaaa35067"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa03315f2-d315-45f7-9f63-0c4db16f161b%2FUntitled.png?width=851&amp;table=block&amp;id=60783d5e-36f0-4614-88cd-642eaaa35067" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/9db983a5072c4cde99c01a4f772ba917" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8278fa73-59f5-4220-baf6-3e4ad28b294f%2FUntitled.png?width=851&amp;table=block&amp;id=9db983a5-072c-4cde-99c0-1a4f772ba917"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8278fa73-59f5-4220-baf6-3e4ad28b294f%2FUntitled.png?width=851&amp;table=block&amp;id=9db983a5-072c-4cde-99c0-1a4f772ba917" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/07d502f5b67e432ca9613826096cac1a" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa3e08bad-91f0-4fa8-b009-3b395e44b5ab%2FUntitled.png?width=851&amp;table=block&amp;id=07d502f5-b67e-432c-a961-3826096cac1a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa3e08bad-91f0-4fa8-b009-3b395e44b5ab%2FUntitled.png?width=851&amp;table=block&amp;id=07d502f5-b67e-432c-a961-3826096cac1a" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></article>  <footer class="Footer">
        <div>&copy; Sparsh Agarwal 2021</div>
        <div>&centerdot;</div>
        <div>Powered by <a target="_blank" href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>