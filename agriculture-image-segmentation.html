<!DOCTYPE html>
<html lang="en">

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5F9Y9HC95G"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5F9Y9HC95G');
</script>
<script data-ad-client="ca-pub-8325812071117232" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Agricultural Image Segmentation">
    <meta property="og:type" content="blog">
  <title>Agricultural Image Segmentation</title>
<link rel="icon" href="⚡"/>
  <!-- Favicon -->
    <link rel="shortcut icon" href="⚡">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index">
      <div class="Navbar__Btn"><span>⚡</span> <span>Home</span></div>
    </a>
                                                                                                                                                    <span class="Navbar__Delim">&centerdot;</span>
    <a href="projects">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/server.svg"></span> <span>Projects</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="notes">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/folder.svg"></span> <span>Notes</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="apps">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/droplet.svg"></span> <span>Apps</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="about">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/send.svg"></span> <span>About</span></div>
    </a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </nav>
  <header class="Header">
          <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
        <h1 class="Header__Title">Agricultural Image Segmentation</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Wed, Jan 6, 2021</span>
                            </div>
          </header>
      <article id="https://www.notion.so/1bebf8ce096e474c84486a0f3afc8048" class="PageRoot"><div id="https://www.notion.so/2df02f7cead542f288437b926fcaebe5" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1316d22-f54f-4af7-bc96-acd60e23cddf%2FUntitled.png?width=949&amp;table=block&amp;id=2df02f7c-ead5-42f2-8843-7b926fcaebe5"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1316d22-f54f-4af7-bc96-acd60e23cddf%2FUntitled.png?width=949&amp;table=block&amp;id=2df02f7c-ead5-42f2-8843-7b926fcaebe5" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h1 id="https://www.notion.so/1aa798fe96be4fd584a9b3ebc9570231" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/1aa798fe96be4fd584a9b3ebc9570231"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Data</span></span></h1><div id="https://www.notion.so/1b83ba0a296044ed8909ac5a6fe00ea7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1 image with 1800 x 1135 resolution and 60 channels</span></span></p></div><div id="https://www.notion.so/75c14ee474624c329f6ec8704ef24c1b" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F20ded986-ab09-47a0-86ab-8f334099fe96%2FUntitled.png?width=1117&amp;table=block&amp;id=75c14ee4-7462-4c32-9f6e-c8704ef24c1b"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F20ded986-ab09-47a0-86ab-8f334099fe96%2FUntitled.png?width=1117&amp;table=block&amp;id=75c14ee4-7462-4c32-9f6e-c8704ef24c1b" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f6861007c24b4af1853ead07b21d85e0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">There are 60 bands given by images.tif. The labels data given by labels.tif. There are 8 labels ranging from 1 to 8. 0 value in the label image means no data label available for that pixel. So, it requires a loss function that ignores nodata label (0).</span></span></p></div><div id="https://www.notion.so/27c2bafea07641e29508fdd8d6254c2f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Every Month 5 bands images were shot from agricultural land for 12 months. So, 5 bands * 12 = 60 bands. The 8 labels mean, 8 types of cropland. There is an assumption that the spectral signal of each crop type varies with bands and months.</span></span></p></div><div id="https://www.notion.so/cdc5df9a8acd436780bb167a1522e5ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The goal of semantic segmentation is to produce a map of croplands. So, the output will be the same size of labels.tif, with all 0 (no labels) pixels classified into one of 8 classes.</span></span></p></div><div id="https://www.notion.so/aff25b1b55c24a7e9ca02540c184492d" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0df09da3-a40c-42f8-8436-66cd01f0f9ba%2FUntitled.png?width=943&amp;table=block&amp;id=aff25b1b-55c2-4a7e-9ca0-2540c184492d"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0df09da3-a40c-42f8-8436-66cd01f0f9ba%2FUntitled.png?width=943&amp;table=block&amp;id=aff25b1b-55c2-4a7e-9ca0-2540c184492d" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/616282c64d394c8aa9e19ede6e5ad650" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Labels: 1 → Crop A, 2 → Crop B, 3 → Crop C, 4 → Crop D, 6 → Crop E, 7 → Crop F, 8 → Crop G</span></span></p></div><div id="https://www.notion.so/50ce5f0468c94665a17d00feb4eb28cb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Sample images required for training and validation can be generated by patching with a sliding window. The size of the patches depends on the model to be applied. Input is a whole 60 bands image. If the model does not support the input of 60 bands image, it is reduced into 3 bands by PCA.</span></span></p></div><h1 id="https://www.notion.so/def354a43010439c9e8cc3c3a2bb4dd0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/def354a43010439c9e8cc3c3a2bb4dd0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Bag of tricks</span></span></h1><ol class="NumberedListWrapper"><li id="https://www.notion.so/b000db17ccdb451b8e77ea2607ad0ea1" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">Adaptive histogram equalization [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://towardsdatascience.com/histogram-equalization-5d1013626e64">ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/a493b21c4b1746f99704f2da62739a6f" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">Image Augmentation with </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/albumentations-team/albumentations">Albumentations</a></span></span></li><li id="https://www.notion.so/9c1829f289b14daeb3816578cd8f2f6c" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Normalized 3d numpy array - overall or channel-wise</span></span></li><li id="https://www.notion.so/00f5fe8b22f844349793f87ed6c6e59e" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">Label balancing - how? - sampler</span></span></li><li id="https://www.notion.so/edd216b1a89544ea8ad6b20cea9cea55" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString">Try Fine-grained U-net (FG-Unet) architecture</span></span></li><li id="https://www.notion.so/1c8d8653194a4e2794ff7b90dbe834a8" class="NumberedList" value="6"><span class="SemanticStringArray"><span class="SemanticString">Add sobel edge detection logic in loss function</span></span></li><li id="https://www.notion.so/cdaa422b39b64c6a9827412456081703" class="NumberedList" value="7"><span class="SemanticStringArray"><span class="SemanticString">Try WDL instead of WBCE [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/killthekitten/kaggle-carvana-2017/blob/master/losses.py">Ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/b520b758024e4405b5accfd8ec9e1a6e" class="NumberedList" value="8"><span class="SemanticStringArray"><span class="SemanticString">How to add pixel weighting component [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/jaidevd/jaidevd.github.io/blob/source/blog/posts/code/weighted_loss_unet.py">Ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/9401da7d818c40f8b9f9e682f0d5f531" class="NumberedList" value="9"><span class="SemanticStringArray"><span class="SemanticString">RGB Weight initialization scheme? [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/olgaliak/segmentation-unet-maskrcnn/blob/master/unet/model.py">Ref</a></span><span class="SemanticString">] [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://arxiv.org/abs/1801.05746">Ref</a></span><span class="SemanticString">]</span></span></li><li id="https://www.notion.so/03dd6cdeadcf42f88d990e6a5639147e" class="NumberedList" value="10"><span class="SemanticStringArray"><span class="SemanticString">Baseline: Vanilla Deep UNet</span></span></li><li id="https://www.notion.so/4a61ade4074c4964aee0ce6b859747b2" class="NumberedList" value="11"><span class="SemanticStringArray"><span class="SemanticString">+ Residual connection</span></span></li><li id="https://www.notion.so/8e25d1b689f6454b8880df2106c45cc4" class="NumberedList" value="12"><span class="SemanticStringArray"><span class="SemanticString">+ Atrous convolutions</span></span></li><li id="https://www.notion.so/b1e08838fab14c449c6d0bc357250782" class="NumberedList" value="13"><span class="SemanticStringArray"><span class="SemanticString">+ Pyramid scene parse pooling</span></span></li><li id="https://www.notion.so/dce71d3f5897437a9b15853d3b3a59aa" class="NumberedList" value="14"><span class="SemanticStringArray"><span class="SemanticString">+ Multitask inference</span></span></li><li id="https://www.notion.so/bf60061ec66e4f61b60c23a74588b739" class="NumberedList" value="15"><span class="SemanticStringArray"><span class="SemanticString">+ CRF post processing</span></span></li><li id="https://www.notion.so/452485ed17e846c6a2cc2fb15568d6d9" class="NumberedList" value="16"><span class="SemanticStringArray"><span class="SemanticString">+ Boundary sharpening</span></span></li><li id="https://www.notion.so/a147b47be28b4479b5790b7977934e51" class="NumberedList" value="17"><span class="SemanticStringArray"><span class="SemanticString">+ Fine grained Unet</span></span></li><li id="https://www.notion.so/6b59ccd5d878427bb8306877c78f5418" class="NumberedList" value="18"><span class="SemanticStringArray"><span class="SemanticString">+ Late temporal fusion</span></span></li><li id="https://www.notion.so/0284a80fa1964d7b98b3a18f13b7179c" class="NumberedList" value="19"><span class="SemanticStringArray"><span class="SemanticString">+ Percentile normalization fitting</span></span></li><li id="https://www.notion.so/bb1a0613b575486ca5e8eb00aabe35ef" class="NumberedList" value="20"><span class="SemanticStringArray"><span class="SemanticString">+ Patch normalization transform</span></span></li><li id="https://www.notion.so/7ebcbdb4dee443248d3490ab4577d90c" class="NumberedList" value="21"><span class="SemanticStringArray"><span class="SemanticString">+ Lower threshold (90%)</span></span></li><li id="https://www.notion.so/90c83be322f9489f97d225b3ce09b614" class="NumberedList" value="22"><span class="SemanticStringArray"><span class="SemanticString">+ On fly patch generation</span></span></li><li id="https://www.notion.so/c0a84011fb044c718de74a5b16d8acaf" class="NumberedList" value="23"><span class="SemanticStringArray"><span class="SemanticString">+ Patch stitch averaging</span></span></li></ol><h3 id="https://www.notion.so/91a6877a21b4486cbd9e5e9bbbc2958c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/91a6877a21b4486cbd9e5e9bbbc2958c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Augmentation scheme</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/a1070d42981745cfbd4301299a54bc78" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Random rotation by 90 degrees</span></span></li><li id="https://www.notion.so/5d508844eb3a467b80ead41b02f66661" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Horizontal and Vertical flip</span></span></li><li id="https://www.notion.so/049255d1e6464474aa6b42cf64cc639c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Heavy Geometric Transformations</span></span></li><li id="https://www.notion.so/01a1258e25ed4e1d804a0a32249a80f9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Random HSV</span></span></li><li id="https://www.notion.so/80ed3838e55a457a8b456feac363f088" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Loss-less augmentation</span></span></li><li id="https://www.notion.so/1b7660cec7c84721aa873541455b5ca5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Channel shuffling</span></span></li><li id="https://www.notion.so/eeb37714d25b4f4780a0e38e051ddc7c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Data augmentation based on class frequency</span></span></li><li id="https://www.notion.so/074aad3b41b542638e50adcc67d24183" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Apply gaussian noise</span></span></li><li id="https://www.notion.so/04884c501a6041ec82225f5bf4bb19aa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Scale by a random factor from 0.8 to 1.2</span></span></li><li id="https://www.notion.so/8d90e7a90de547ffa44c7c2a6cdfdf96" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Brighness changing</span></span></li></ul><h3 id="https://www.notion.so/256a031f2be6433ab0c6e25ab91ebb60" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/256a031f2be6433ab0c6e25ab91ebb60"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Loss functions</span></span></h3><details id="https://www.notion.so/2604766b98d544dcb7f205cdefb1b60c" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Ref images</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/69e5124c4d544e3086c24b17e5b60d97" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F657ac98e-a12d-45a7-87c7-64dd79fc508f%2FUntitled.png?width=984&amp;table=block&amp;id=69e5124c-4d54-4e30-86c2-4b17e5b60d97"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F657ac98e-a12d-45a7-87c7-64dd79fc508f%2FUntitled.png?width=984&amp;table=block&amp;id=69e5124c-4d54-4e30-86c2-4b17e5b60d97" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/5f9a200327ae49659befbfd166bfd6b8" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9801a21c-6451-4e53-8fa3-e0b050a99eee%2FUntitled.png?width=984&amp;table=block&amp;id=5f9a2003-27ae-4965-9bef-bfd166bfd6b8"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9801a21c-6451-4e53-8fa3-e0b050a99eee%2FUntitled.png?width=984&amp;table=block&amp;id=5f9a2003-27ae-4965-9bef-bfd166bfd6b8" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/154e42fb8f914abca85564abde7b6419" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9536f18a-ad44-443a-b651-f2fe381a9b0c%2FUntitled.png?width=1507&amp;table=block&amp;id=154e42fb-8f91-4abc-a855-64abde7b6419"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9536f18a-ad44-443a-b651-f2fe381a9b0c%2FUntitled.png?width=1507&amp;table=block&amp;id=154e42fb-8f91-4abc-a855-64abde7b6419" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></details><details id="https://www.notion.so/c9f15896fbe64f7f9346634fc470d3c4" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Code snippets</span></span></summary><div class="Toggle__Content"><pre id="https://www.notion.so/789a7a06f6a04123a912634aa6cae9b2" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">soft_dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token triple-quoted-string string">''' 
    Soft dice loss calculation for arbitrary batch size, number of classes, and number of spatial dimensions.
    Assumes the `channels_last` format.
  
    # Arguments
        y_true: b x X x Y( x Z...) x c One hot encoding of ground truth
        y_pred: b x X x Y( x Z...) x c Network output, must sum to 1 over c channel (such as after softmax) 
        epsilon: Used for numerical stability to avoid divide by zero errors
    
    # References
        V-Net: Fully Convolutional Neural Networks for Volumetric Medical Image Segmentation 
        https://arxiv.org/abs/1606.04797
        More details on Dice loss formulation 
        https://mediatum.ub.tum.de/doc/1395260/1395260.pdf (page 72)
        
        Adapted from https://github.com/Lasagne/Recipes/issues/99#issuecomment-347775022
    '''</span>
    
    <span class="token comment"># skip the batch and class axis for calculating Dice score</span>
    axes <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    numerator <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_pred <span class="token operator">*</span> y_true<span class="token punctuation">,</span> axes<span class="token punctuation">)</span>
    denominator <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_true<span class="token punctuation">)</span><span class="token punctuation">,</span> axes<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>numerator <span class="token operator">/</span> <span class="token punctuation">(</span>denominator <span class="token operator">+</span> epsilon<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># average over classes and batch</span></span></span></span></code></pre><pre id="https://www.notion.so/851b6794944143839ef084d743f280dd" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">jaccard_coef</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    intersection <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">*</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sum_ <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">+</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    jac <span class="token operator">=</span> <span class="token punctuation">(</span>intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sum_ <span class="token operator">-</span> intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span>
    <span class="token keyword">return</span> K<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>jac<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
  numerator <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true <span class="token operator">*</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  denominator <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true <span class="token operator">+</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> numerator <span class="token operator">/</span> denominator


<span class="token keyword">def</span> <span class="token function">focal_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    output <span class="token operator">/=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    eps <span class="token operator">=</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> K<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>output<span class="token punctuation">,</span> eps<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">-</span> eps<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>K<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">-</span> output<span class="token punctuation">,</span> gamma<span class="token punctuation">)</span> <span class="token operator">*</span> target <span class="token operator">*</span> K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span></span></span></code></pre><pre id="https://www.notion.so/3261078c8ee246eb98b137f411854166" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">weighted_categorical_crossentropy</span><span class="token punctuation">(</span>weights<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A weighted version of keras.objectives.categorical_crossentropy
    
    Variables:
        weights: numpy array of shape (C,) where C is the number of classes
    
    Usage:
        weights = np.array([0.5,2,10]) # Class one at 0.5, class 2 twice the normal weights, class 3 10x.
        loss = weighted_categorical_crossentropy(weights)
        model.compile(loss=loss,optimizer='adam')
    """</span>
    
    weights <span class="token operator">=</span> K<span class="token punctuation">.</span>variable<span class="token punctuation">(</span>weights<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># scale predictions so that the class probas of each sample sum to 1</span>
        y_pred <span class="token operator">/=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token comment"># clip to prevent NaN's and Inf's</span>
        y_pred <span class="token operator">=</span> K<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># calc</span>
        loss <span class="token operator">=</span> y_true <span class="token operator">*</span> K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span> <span class="token operator">*</span> weights
        loss <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>loss<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> loss
    
    <span class="token keyword">return</span> loss</span></span></span></code></pre><pre id="https://www.notion.so/032622a8de3d42fbb3cdd0633a4fa457" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">dice_coeff</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    smooth <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">.</span>
    <span class="token comment"># Flatten</span>
    y_true_f <span class="token operator">=</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    y_pred_f <span class="token operator">=</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    intersection <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true_f <span class="token operator">*</span> y_pred_f<span class="token punctuation">)</span>
    score <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">*</span> intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_true_f<span class="token punctuation">)</span> <span class="token operator">+</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y_pred_f<span class="token punctuation">)</span> <span class="token operator">+</span> smooth<span class="token punctuation">)</span>
    <span class="token keyword">return</span> score

<span class="token keyword">def</span> <span class="token function">dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> dice_coeff<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss

<span class="token keyword">def</span> <span class="token function">bce_dice_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> losses<span class="token punctuation">.</span>binary_crossentropy<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span> <span class="token operator">+</span> dice_loss<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss</span></span></span></code></pre><pre id="https://www.notion.so/e086077a7ede4ca9bad698fa9702e195" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>_EPSILON <span class="token operator">=</span> K<span class="token punctuation">.</span>epsilon<span class="token punctuation">(</span><span class="token punctuation">)</span>
nb_class<span class="token operator">=</span><span class="token number">9</span> <span class="token comment"># number of objects plus the background</span>
<span class="token keyword">def</span> <span class="token function">custom_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
  y_pred <span class="token operator">=</span> K<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> _EPSILON<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token operator">-</span>_EPSILON<span class="token punctuation">)</span>

  <span class="token comment"># find predictions</span>
  pred<span class="token operator">=</span>K<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment"># find missing annotations per class</span>
  y_trueAny<span class="token operator">=</span>K<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  <span class="token comment">#print "missing annotations",K.eval(y_trueAny)</span>

  backgroundWeights<span class="token operator">=</span><span class="token number">1</span>
  <span class="token keyword">for</span> cls <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>nb_class<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token comment"># we use repeat to get the same size as other tensors</span>
      y_trueAnyRepeat<span class="token operator">=</span>K<span class="token punctuation">.</span>repeat_elements<span class="token punctuation">(</span>y_trueAny<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>cls<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token comment">#print "repeat shape",K.eval(K.shape(y_trueAnyRepeat))</span>
      
      <span class="token comment"># check for two conditions</span>
      <span class="token comment"># 1- annotation missing</span>
      <span class="token comment"># 2- prediction is equal to missing class/object</span>
      backgroundWeights<span class="token operator">*=</span>K<span class="token punctuation">.</span>not_equal<span class="token punctuation">(</span>pred<span class="token punctuation">,</span>cls<span class="token punctuation">)</span><span class="token operator">+</span>y_trueAnyRepeat
      <span class="token comment">#print "background weights shape",K.eval(K.shape(backgroundWeights)),K.eval(K.shape(pred))</span>
      <span class="token comment">#print "sum of background weights",cls,K.eval(K.sum(backgroundWeig0.191179hts))</span>

  <span class="token comment"># loss for background</span>
  loss<span class="token operator">=</span>backgroundWeights<span class="token operator">*</span>y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> cls <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>nb_class<span class="token punctuation">)</span><span class="token punctuation">:</span>
      loss<span class="token operator">+=</span>y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>cls<span class="token punctuation">]</span><span class="token operator">*</span>K<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>cls<span class="token punctuation">]</span><span class="token punctuation">)</span>
      
  <span class="token keyword">return</span> <span class="token operator">-</span>loss</span></span></span></code></pre><pre id="https://www.notion.so/3c8706bdfbbf49948d0224d8cac43c29" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">dice_coef_rb</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> smooth<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_true <span class="token operator">=</span> K<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> <span class="token string">'int32'</span><span class="token punctuation">)</span>
    y_true <span class="token operator">=</span> K<span class="token punctuation">.</span>one_hot<span class="token punctuation">(</span>y_true<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    y_pred <span class="token operator">=</span> y_pred<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    intersection <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">*</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sum_ <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_true <span class="token operator">+</span> y_pred<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> K<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">*</span> intersection <span class="token operator">+</span> smooth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sum_ <span class="token operator">+</span> smooth<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">dice_coef_loss_rb</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> dice_coef_rb<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span></span></span></code></pre></div></details><ol class="NumberedListWrapper"><li id="https://www.notion.so/ad09b8854bf14b5eb5d9aa2286e19608" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">Dice loss</span></span></li><li id="https://www.notion.so/188b319fb02a44cda43d914d54a73796" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">Class weights</span></span></li><li id="https://www.notion.so/f6d97def549641588efd14d895739c38" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Pixel weighted (weighted boundary loss - </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.kaggle.com/lyakaap/weighing-boundary-pixels-loss-script-by-keras2">code</a></span><span class="SemanticString">)</span></span></li><li id="https://www.notion.so/4b8956cd5dbb4ab8ac869f774f095e63" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">Combination of BCE, Dice and Focal</span></span></li></ol><h3 id="https://www.notion.so/fdaa3084ba254d9bb5f6801231aab0c6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/fdaa3084ba254d9bb5f6801231aab0c6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Hyperparameters</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/df44a0ff0c38478f9b2fd1ea3ec7e0a8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Binary class vs. Multiclass</span></span></li><li id="https://www.notion.so/a2e6cd8d321b4a9792bc679bc9b3c003" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Standardisation channel-wise or image-wise</span></span></li><li id="https://www.notion.so/8e8d3a727f044977b76c2f244dd3f754" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Class weights</span></span></li><li id="https://www.notion.so/8e79751cc25b44ff8e45cce4d638681b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Patch-based vs. Stride</span></span></li><li id="https://www.notion.so/8f0bc9ac02184ca5b2366906e3f20796" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Augmentation</span></span></li><li id="https://www.notion.so/bd1bb558ab5143eea1d4e1c918c6c762" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">U-net model architecture</span></span></li><li id="https://www.notion.so/d59903e38ac748539a166d76a5e1ff98" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Loss function</span></span></li></ul><h1 id="https://www.notion.so/0b91760e47ef4f6895b4c71af30e70df" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/0b91760e47ef4f6895b4c71af30e70df"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Results and Discussion</span></span></h1><div id="https://www.notion.so/dd914631c50d447784d2ec6f8f08f36e" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4312e869-4afd-4018-955f-e36ece5ae8f6%2FUntitled.png?width=851&amp;table=block&amp;id=dd914631-c50d-4477-84d2-ec6f8f08f36e"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4312e869-4afd-4018-955f-e36ece5ae8f6%2FUntitled.png?width=851&amp;table=block&amp;id=dd914631-c50d-4477-84d2-ec6f8f08f36e" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/12a05624375c49af9c251fa465c3ca01" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc491844a-d08e-43ea-9133-a131ffdc2bfe%2FUntitled.png?width=851&amp;table=block&amp;id=12a05624-375c-49af-9c25-1fa465c3ca01"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc491844a-d08e-43ea-9133-a131ffdc2bfe%2FUntitled.png?width=851&amp;table=block&amp;id=12a05624-375c-49af-9c25-1fa465c3ca01" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/285111f7b83d47539196f238ed789e83" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa03315f2-d315-45f7-9f63-0c4db16f161b%2FUntitled.png?width=851&amp;table=block&amp;id=285111f7-b83d-4753-9196-f238ed789e83"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa03315f2-d315-45f7-9f63-0c4db16f161b%2FUntitled.png?width=851&amp;table=block&amp;id=285111f7-b83d-4753-9196-f238ed789e83" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1897a4702d4243fa9bf9f9e46c03215b" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8278fa73-59f5-4220-baf6-3e4ad28b294f%2FUntitled.png?width=851&amp;table=block&amp;id=1897a470-2d42-43fa-9bf9-f9e46c03215b"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8278fa73-59f5-4220-baf6-3e4ad28b294f%2FUntitled.png?width=851&amp;table=block&amp;id=1897a470-2d42-43fa-9bf9-f9e46c03215b" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/8ec7a9a685674e768c359bad21d7f910" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa3e08bad-91f0-4fa8-b009-3b395e44b5ab%2FUntitled.png?width=851&amp;table=block&amp;id=8ec7a9a6-8567-4e76-8c35-9bad21d7f910"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa3e08bad-91f0-4fa8-b009-3b395e44b5ab%2FUntitled.png?width=851&amp;table=block&amp;id=8ec7a9a6-8567-4e76-8c35-9bad21d7f910" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></article>  <footer class="Footer">
        <div>&copy; Sparsh Agarwal 2021</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>